[meta]
name = "Script Generation"
description = "A blueprint for generating scripts using AI."
id = "ScriptGeneration"
version = "0.1.0"
author = "Tutopanda"
license = "MIT"

[[inputs]]
name = "InquiryPrompt"
description = "The prompt describing the movie script to be generated."
type = "string"
cardinality = "single"
required = true

[[inputs]]
name = "Duration"
description = "The desired duration of the movie in seconds"
type = "int"
cardinality = "single"
required = true

[[inputs]]
name = "NumOfSegments"
description = "The number of segments to divide the movie into."
type = "int"
cardinality = "single"
required = true

[[inputs]]
name = "Audience"
description = "The target audience for the movie (e.g., children, adults, experts)."
type = "string"
cardinality = "single"
required = false
default = "Adult"

[[inputs]]
name = "Language"
description = "The language in which the movie will be narrated."
type = "string"
cardinality = "single"
required = false
default = "en"

[[outputs]] 
name = "MovieTitle"
description = "The title of the movie."
type = "string"
cardinality = "single"
required = true

[[outputs]]
name = "MovieSummary"
description = "A brief summary of the movie."
type = "string"
cardinality = "single"
required = true

[[outputs]]
name = "NarrationScript"
description = "The script for the movie narration."
type = "array"
cardinality = "perSegment"
itemType = "string"
required = true

[graph]
nodes = [
    { inputRef = "InquiryPrompt", cardinality = "single" },
    { inputRef = "Audience", cardinality = "single" },
    { inputRef = "Duration", cardinality = "single" },
    { inputRef = "NumOfSegments", cardinality = "single" },
    { inputRef = "Language", cardinality = "single" },
    { producerRef = "ScriptProducer", cardinality = "single" },
    { outputRef = "MovieTitle", cardinality = "single" },
    { outputRef = "MovieSummary", cardinality = "single" },
    { outputRef = "NarrationScript", cardinality = "perSegment" }
]
edges = [
    { from = "InquiryPrompt", to = "ScriptProducer" },
    { from = "Audience", to = "ScriptProducer" },
    { from = "Duration", to = "ScriptProducer" },
    { from = "NumOfSegments", to = "ScriptProducer" },
    { from = "Language", to = "ScriptProducer" },
    { from = "ScriptProducer", to = "MovieTitle" },
    { from = "ScriptProducer", to = "MovieSummary" },
    { from = "ScriptProducer", to = "NarrationScript", perSegment = true }
]

[[producers]]
name = "ScriptProducer"
provider = "openai"
model = "gpt-5-mini"
settings = { temperature = 0.7, max_tokens = 1500 }
textFormat = "json_schema"
jsonSchema = """
{
  "schema": {
    "type": "object",
    "properties": {
      "movieTitle": {
        "type": "string",
        "description": "Provide a concise title for the lecture, not more than 3 to 5 words."
      },
      "movieSummary": {
        "type": "string",
        "description": "Provide a detailed written summary for supplemental reading."
      },
      "narrationScript": {
        "type": "array",
        "description": "Provide narration text for the segment.",
        "items": { "type": "string" }
      }
    },
    "required": ["movieTitle", "movieSummary", "narrationScript"],
    "additionalProperties": false
  }
}
"""
variables = ["Audience","Duration","NumOfSegments","Language","InquiryPrompt"]
systemPrompt = """
You are an expert historical researcher and documentary script writer.
The user will supply a historical topic and wants to learn about it.
Your job is to produce a documentary-style narrated lecture tailored to the provided configuration.
Divide the lecture into segments that synchronize with the narration.
Research the topic carefully before writing so the content is factual and recent.
Always return content that strictly matches the output schema; no additional commentary.
"""
userPrompt = """
Write the narrated lecture so the total speaking time covers {{Duration}} seconds.
Structure the content into segments that align with 10 seconds, adjusting when the narrative flow demands it.
Deliver the narration in {{Language}}, keeping terminology accurate for that language and avoiding stage directions.
Topic:
{{InquiryPrompt}}
"""
